
\documentclass[10pt,a4paper,onecolumn]{article}

% --- Encoding and fonts for pdfLaTeX ---
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\renewcommand\familydefault{\sfdefault}

% --- Packages ---
\usepackage{marginnote}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{authblk,etoolbox}
\usepackage{titlesec}
\usepackage{calc}
\usepackage{tikz}
\usepackage{hyperref}
\hypersetup{colorlinks, breaklinks=true,
            urlcolor=[rgb]{0.0, 0.5, 1.0},
            linkcolor=[rgb]{0.0, 0.5, 1.0},
            unicode=true,
            pdftitle={The Population Synthesis Toolkit (PST) Python Library},
            pdfborder={0 0 0}}
\usepackage{caption}
\usepackage{tcolorbox}
\usepackage{amssymb,amsmath}
\usepackage{seqsplit}
\usepackage{xstring}
\usepackage{float}
\usepackage[top=3.5cm, bottom=3cm, right=1.5cm, left=1.0cm,
            headheight=2.2cm, reversemp, includemp, marginparwidth=4.5cm]{geometry}
\usepackage{fancyhdr}
\usepackage{parskip}

% --- Bibliography ---
\usepackage[backend=biber]{biblatex}
\bibliography{paper.bib}

% --- Redefine figure float ---
\let\origfigure\figure
\let\endorigfigure\endfigure
\renewenvironment{figure}[1][2] {\origfigure[H]} {\endorigfigure}

% --- Monospace formatting for line breaking ---
\let\textttOrig=\texttt
\def\texttt#1{\textttOrig{\seqsplit{#1}}}
\renewcommand{\seqinsert}{\ifmmode\allowbreak\else\penalty6000\hspace{0pt plus 0.02em}\fi}

% --- Smart hyperlink display for identical link/text and DOIs ---
\makeatletter
\let\href@Orig=\href
\def\href@Urllike#1#2{\href@Orig{#1}{\begingroup\def\Url@String{#2}\Url@FormatString\endgroup}}
\def\href@Notdoi#1#2{\def\tempa{#1}\def\tempb{#2}%
  \ifx\tempa\tempb\relax\href@Urllike{#1}{#2}\else\href@Orig{#1}{#2}\fi}
\def\href#1#2{%
  \IfBeginWith{#1}{https://doi.org}%
  {\href@Urllike{#1}{#2}}{\href@Notdoi{#1}{#2}}}
\makeatother

% --- Hanging indent for references ---
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[3]%
 {%
  \setlength{\parindent}{0pt}
  \ifodd #1 \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces\fi
  \ifnum #2 > 0
  \setlength{\parskip}{#2\baselineskip}
  \fi
 }{}

\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

% --- Section style ---
\titleformat{\section}{\normalfont\sffamily\Large\bfseries}{}{0pt}{}
\titleformat{\subsection}{\normalfont\sffamily\large\bfseries}{}{0pt}{}
\titleformat{\subsubsection}{\normalfont\sffamily\bfseries}{}{0pt}{}
\titleformat*{\paragraph}{\sffamily\normalsize}

% --- Header/Footer style ---
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0.25pt}
\fancyhead[L]{\hspace{-0.75cm}\includegraphics[width=5.5cm]{./logo.png}}
\fancyfoot[L]{\parbox[t]{0.98\headwidth}{\footnotesize{\sffamily citation_author, (2025). The Population Synthesis Toolkit (PST) Python Library. \textit{Journal of Open Source Software}, VOL(ISSUE), PAGE. \url{https://doi.org/DOI unavailable}}}}
\fancyfoot[R]{\sffamily \thepage}
\makeatletter
\let\ps@plain\ps@fancy
\fancyheadoffset[L]{4.5cm}
\fancyfootoffset[L]{4.5cm}
\makeatother

% --- Misc settings ---
\setcounter{secnumdepth}{0}
\setlength{\emergencystretch}{3em}
\providecommand{\tightlist}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% --- Title/Affiliation patches ---
\patchcmd{\@maketitle}{center}{flushleft}{}{}
\patchcmd{\@maketitle}{\LARGE}{\LARGE\sffamily}{}{}
\def\maketitle{{%
  \renewenvironment{tabular}[2][] {\begin{flushleft}}{\end{flushleft}}%
  \AB@maketitle}}
\makeatletter
\renewcommand\AB@affilsepx{ \protect\Affilfont}
\renewcommand\AB@affilnote[1]{{\bfseries #1}\hspace{3pt}}
\renewcommand\Authfont{\sffamily\bfseries}
\renewcommand\Affilfont{\sffamily\small\mdseries}
\setlength{\affilsep}{1em}
\makeatother

% --- Color + icon helper ---
\definecolor{linky}{rgb}{0.0, 0.5, 1.0}
\newtcolorbox{repobox}{colback=red, colframe=red!75!black,
  boxrule=0.5pt, arc=2pt, left=6pt, right=6pt, top=3pt, bottom=3pt}
\newcommand{\ExternalLink}{%
   \tikz[x=1.2ex, y=1.2ex, baseline=-0.05ex]{%
       \begin{scope}[x=1ex, y=1ex]
           \clip (-0.1,-0.1)--++(-0,1.2)--++(0.6,0)--++(0,-0.6)--++(0.6,0)--++(0,-1);
           \path[draw,line width = 0.5,rounded corners=0.5](0,0) rectangle (1,1);
       \end{scope}
       \path[draw, line width = 0.5] (0.5, 0.5)--(1,1);
       \path[draw, line width = 0.5] (0.6, 1)--(1, 1)--(1, 0.6);
   }}

% --- Title and Author Info ---
\title{The Population Synthesis Toolkit (PST) Python Library}
\author[1]{Pablo Corcho-Caballero}
\author[2,3]{Yago Ascasibar}
\author[4]{Daniel Jim\'enez-L\'opez}
\affil[1]{Kapteyn Astronomical Institute, University of Groningen, The Netherlands}
\affil[2]{Department of Theoretical Physics, Universidad Aut\'onoma de Madrid (UAM), Spain}
\affil[3]{Centro de Investigaci\'on Avanzada en F\'isica Fundamental (CIAFF-UAM), Spain}
\affil[4]{Observatorio Astron\'omico Nacional (OAN), Spain}
\date{\vspace{-7ex}}

\begin{document}
\maketitle
\end{document}
